"0","# create buffer around metro stations. First transform to sp to use buffer function"
"0","all_stations_nad <- st_transform(all_stations, crs = NAD83)"
"0","all_stations_sp <- as(all_stations_nad, ""Spatial"")"
"0","all_stations_coords <- st_coordinates(all_stations)"
"0","all_stations_buffer <- buffer(all_stations_sp, width=300)"
"0","all_stations_buffer <- st_as_sf(all_stations_buffer)"
"0","all_stations_buffer <- st_transform(all_stations_buffer, crs = WGS84)"
"0",""
"0","all_bike_trips_within_metro_buffer <- st_intersection(all_stations_buffer, a_sf)"
"0","trips_in_buffer_count_start <- all_bike_trips_within_metro_buffer %>% group_by(start_station) %>% summarize(count=n())"
"0","popup_start <- paste(""Station Name: "", trips_in_buffer_count_start$start_station, ""count: "", trips_in_buffer_count_start$count)"
"0","all_bike_stations_within_metro_buffer <- st_intersection(all_stations_buffer, trips_in_buffer_count_start)"
"0",""
"0","leaflet() %>% "
"0","  addProviderTiles(providers$CartoDB.Positron, options = providerTileOptions(opacity = 0.6)) %>% "
"0","  setView(lat=34.06699, lng=-118.2909,zoom=12)%>%"
"0","  addPolygons(data = all_stations_buffer, color = ""darkred"") %>%"
"0","  addPolygons(data = a_hull, color = ""darkred"") %>%"
"0","  addCircleMarkers(data = a_sf, col = ""darkblue4"", radius = 0.7, fillOpacity=0.6, group=""Bike Stations in Convex Hull"")%>%"
"0","  addCircleMarkers(data = all_bike_stations_within_metro_buffer, col = ""black"", radius = 1, popup = all_bike_stations_within_metro_buffer$STATION, group = ""Bike Stations in Metro buffer"") %>%"
"0","  addCircleMarkers(data = trips_in_buffer_count_start, col = ""black"", popup = popup_start, radius=sqrt(trips_in_buffer_count_start$count), opacity=0.4, group = ""Number of Trips from Stations in Metro buffers"")%>%"
"0","  addLayersControl(overlayGroups=c(""Bike Stations in Convex Hull"", ""Bike Stations in Metro buffer"", ""Number of Trips from Stations in Metro buffers""), options=layersControlOptions(collapsed=FALSE))%>%"
"0","  hideGroup(""Number of Trips from Stations in Metro buffers"")"
