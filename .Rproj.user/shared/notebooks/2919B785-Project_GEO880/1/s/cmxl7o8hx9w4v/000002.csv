"0","biketrips_a$weekday <- weekdays(as.Date(biketrips_a$start_day)+1) # the weekday is only correct with +1"
"0","weekday_count <- biketrips_a %>% group_by(start_hour, weekday) %>% summarize(count=n())"
"0","dayLabs<-c(""Montag"",""Dienstag"",""Mittwoch"",""Donnerstag"",""Freitag"",""Samstag"",""Sonntag"") "
"0","weekday_count$weekday <- factor(weekday_count$weekday, levels = rev(dayLabs))"
"0","weekday_count <-weekday_count[order(weekday_count$weekday), ]"
"0",""
"0","# additional plot."
"0","# ggplot(data = weekday_count, mapping = aes(x = start_hour,"
"0","#                                           y = weekday,"
"0","#                                         fill = count)) +"
"0","#                                        geom_tile() +"
"0","#                                        xlab(label = ""Hour"") +"
"0","#                                        ylab(label = ""Weekday"") +"
"0","#                                        ggtitle(""Absolute number of trips for each day"") +"
"0","#                                        scale_fill_gradient(""Count"")"
"0",""
"0","# function to retrieve the statistics for a specific day"
"0","# number is the number of mondays (e.g.) in the dataset. Monday appears 14 times, the rest 13 times"
"0","weekday_count <- biketrips_a %>% group_by(weekday) %>% summarize(count=n())"
"0","weekday_count$weekday <- factor(weekday_count$weekday, levels = dayLabs)"
"0","weekday_count <-weekday_count[order(weekday_count$weekday), ]"
"0","weekday_count$mean_trips <- round(weekday_count$count/14,2) # 14 weeks are included in dataset"
"0","weekday_count$mean_trips[1] <- round(weekday_count$count[1]/15,2) # monday is included 15 times (14 weeks + 1 day)"
"0","weekday_count$percentage <- round(weekday_count$count/sum(weekday_count$count),3)*100"
"0","weekday_count"
