"0","### Metro Station Analysis ###"
"0",""
"0","a_sf <- st_as_sf(biketrips_a, coords = c(""start_lon"", ""start_lat""), crs = WGS84)"
"0","a_sp <- as(a_sf, ""Spatial"")"
"0","a_sp <- spTransform(a_sp, CRS(WGS84))"
"0","a_sf_nad <- st_transform(a_sf, crs = NAD83)"
"0","a_sp_nad <- as(a_sf_nad, ""Spatial"")"
"0","a_coords <- st_coordinates(a_sf)"
"0",""
"0","# Convex Hull to clip to relevant stations"
"0","a_hull <- gConvexHull(a_sp_nad) # use NAD object for buffer because it is a metric system and buffer"
"0","a_hull <- gBuffer(a_hull, width =300) # buffer of 300m"
"0","a_hull <- st_as_sf(a_hull)"
"0","a_hull <- st_transform(a_hull, crs = WGS84)"
"0",""
"0","all_stations_within_a_hull <- st_intersection(a_hull, all_stations)"
"0",""
"0","leaflet() %>% "
"0","  addProviderTiles(providers$CartoDB.Positron, options = providerTileOptions(opacity = 0.6)) %>% "
"0","  setView(lat=34.06699, lng=-118.2909,zoom=11)%>%"
"0","  addPolygons(data = a_hull, color = ""darkred"") %>%"
"0","  addCircleMarkers(data = a_sf, col = ""darkblue4"", radius = 1) %>%"
"0","  addCircleMarkers(data = all_stations, col = ""black"", radius = 2, popup=all_stations$STATION)"
