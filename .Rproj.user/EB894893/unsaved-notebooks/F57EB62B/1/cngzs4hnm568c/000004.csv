"0",""
"0","# get number of stations"
"0","station1 <- biketrips_a$start_station"
"0","station2 <- biketrips_a$end_station"
"0","station1 <- as.vector(station1)"
"0","station2 <- as.vector(station2)"
"0",""
"0","# build a vector with all start and stop stations"
"0","stations <- c(station1, station2)"
"0",""
"0","# remove dublicates"
"0","station <- unique(stations)"
"0","cat(length(station), ""stations are used in cluster A (180 Overall)"")"
"1","103"
"1"," "
"1","stations are used in cluster A (180 Overall)"
"0","hourly_start <- biketrips_a %>% group_by(start_station, start_hour) %>% summarize(count=n())"
"0","colnames(hourly_start) <- c(""Station_ID"", ""Hour"", ""Count_Start"")"
"0","hourly_end <- biketrips_a %>% group_by(end_station, end_hour) %>% summarize(count=n())"
"0","colnames(hourly_end) <- c(""Station_ID"", ""Hour"", ""Count_End"")"
"0","hourly <- hourly_start %>% full_join(hourly_end, copy = FALSE, by= c(""Station_ID"", ""Hour""))"
"0","hourly[is.na(hourly)] <- 0"
"0","hourly$diff <- hourly$Count_Start-hourly$Count_End"
"0","hourly <- hourly %>% inner_join(station_dic, copy = FALSE, by = ""Station_ID"")"
"0",""
"0","## a lot of trips between Union station and Main/1st St (location of Los Angeles Department of Transportation)"
"0","ggplot(data = hourly, mapping = aes(x = Hour,"
"0","                                          y = Station_Name,"
"0","                                        fill = diff)) +"
"0","                                       geom_tile() +"
"0","                                       xlab(label = ""Hour"") +"
"0","                                       ylab(label = ""Start Station"") +"
"0","                                       ggtitle(""Balance of trips starting (positive) and trips ending (negative)"") +"
"0","                                       scale_fill_gradient2(""Difference"")"
